<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="851px" preserveAspectRatio="none" style="width:747px;height:851px;background:#FFFFFF;" version="1.1" viewBox="0 0 747 851" width="747px" zoomAndPan="magnify"><defs><filter height="300%" id="frj3hrquxh73i" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#frj3hrquxh73i)" height="302.7266" style="stroke:#000000;stroke-width:2.0;" width="723" x="10" y="77.5938"/><rect fill="#FFFFFF" filter="url(#frj3hrquxh73i)" height="376.3359" style="stroke:#000000;stroke-width:2.0;" width="723" x="10" y="394.3203"/><rect fill="#FFFFFF" height="177.6016" style="stroke:none;stroke-width:1.0;" width="723" x="10" y="415.4531"/><rect fill="#FFFFFF" height="177.6016" style="stroke:none;stroke-width:1.0;" width="723" x="10" y="593.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="60.5938" y2="561.0547"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="561.0547" y2="593.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="593.0547" y2="738.6563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="120" x2="120" y1="738.6563" y2="770.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120" x2="120" y1="770.6563" y2="787.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="405" x2="405" y1="60.5938" y2="561.0547"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="405" x2="405" y1="561.0547" y2="593.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="405" x2="405" y1="593.0547" y2="738.6563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="405" x2="405" y1="738.6563" y2="770.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="405" x2="405" y1="770.6563" y2="787.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="609" x2="609" y1="60.5938" y2="561.0547"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="609" x2="609" y1="561.0547" y2="593.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="609" x2="609" y1="593.0547" y2="738.6563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="609" x2="609" y1="738.6563" y2="770.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="609" x2="609" y1="770.6563" y2="787.6563"/><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="50.5938" style="stroke:#A80036;stroke-width:1.5;" width="97" x="70" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="79" y="26.9951">FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="87.5" y="43.292">REST API</text><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="50.5938" style="stroke:#A80036;stroke-width:1.5;" width="97" x="70" y="786.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="79" y="808.6514">FHIR Server</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="87.5" y="824.9482">REST API</text><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="375" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="384" y="43.292">Client</text><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="34.2969" style="stroke:#A80036;stroke-width:1.5;" width="57" x="375" y="786.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="384" y="808.6514">Client</text><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="50.5938" style="stroke:#A80036;stroke-width:1.5;" width="123" x="546" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="555" y="26.9951">Client Endpoint</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="577" y="43.292">(HTTP/S)</text><rect fill="#FEFECE" filter="url(#frj3hrquxh73i)" height="50.5938" style="stroke:#A80036;stroke-width:1.5;" width="123" x="546" y="786.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="555" y="808.6514">Client Endpoint</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="577" y="824.9482">(HTTP/S)</text><path d="M10,77.5938 L242,77.5938 L242,88.5938 L232,98.5938 L10,98.5938 L10,77.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="302.7266" style="stroke:#000000;stroke-width:2.0;" width="723" x="10" y="77.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183" x="27" y="92.6606">Subscription Negotiation</text><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="138.9922" y2="134.9922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="138.9922" y2="142.9922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="404.5" y1="138.9922" y2="138.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="139.5" y="124.3599">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="156.5" y="116.7935">Create Subscription</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="176" x="156.5" y="131.9263">channelType: rest-hook</text><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="393.5" y1="187.2578" y2="183.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="393.5" y1="187.2578" y2="191.2578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="404.5" y1="187.2578" y2="187.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="129.5" y="172.6255">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="146.5" y="165.0591">Success</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="240" x="146.5" y="180.1919">Subscription.status: requested</text><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="265.7891" y2="261.7891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="265.7891" y2="269.7891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="608.5" y1="265.7891" y2="265.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="129.5" y="236.0239">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="146.5" y="213.3247">HTTP POST - Handshake</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="146.5" y="228.4575">Bundle:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="160" x="242.5" y="243.5903">Bundle.type: history</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="272" x="146.5" y="258.7231">SubscriptionStatus.type: handshake</text><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="314.0547" y2="310.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="314.0547" y2="318.0547"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="608.5" y1="314.0547" y2="314.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="139.5" y="299.4224">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="156.5" y="291.856">HTTP Success, e.g.:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="156.5" y="306.9888">200: OK</text><path d="M125,327.0547 L125,371.0547 L366,371.0547 L366,337.0547 L356,327.0547 L125,327.0547 " fill="#FBFB77" filter="url(#frj3hrquxh73i)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M356,327.0547 L356,337.0547 L366,337.0547 L356,327.0547 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="133" y="346.1216">Server updates Subscription:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="216" x="133" y="361.2544">Subscription.status: active</text><path d="M10,394.3203 L278,394.3203 L278,405.3203 L268,415.3203 L10,415.3203 L10,394.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="376.3359" style="stroke:#000000;stroke-width:2.0;" width="723" x="10" y="394.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="219" x="27" y="409.3872">REST Subscription Processing</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="733" y1="416.4531" y2="416.4531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="160" x="17" y="428.6636">[Server sends heartbeat]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="504.7891" y2="500.7891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="504.7891" y2="508.7891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="608.5" y1="504.7891" y2="504.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="129.5" y="475.0239">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="146.5" y="452.3247">HTTP POST - Heartbeat</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="146.5" y="467.4575">Bundle:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="160" x="242.5" y="482.5903">Bundle.type: history</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="272" x="146.5" y="497.7231">SubscriptionStatus.type: heartbeat</text><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="553.0547" y2="549.0547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="553.0547" y2="557.0547"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="608.5" y1="553.0547" y2="553.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="139.5" y="538.4224">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="156.5" y="530.856">HTTP Success, e.g.:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="156.5" y="545.9888">200: OK</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="733" y1="594.0547" y2="594.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="212" x="17" y="606.2651">[Server sends event-notification]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="682.3906" y2="678.3906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="607.5" x2="597.5" y1="682.3906" y2="686.3906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="608.5" y1="682.3906" y2="682.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="129.5" y="652.6255">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="146.5" y="629.9263">HTTP POST - Notification</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="146.5" y="645.0591">Bundle:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="160" x="242.5" y="660.1919">Bundle.type: history</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="344" x="146.5" y="675.3247">SubscriptionStatus.type: event-notification</text><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="730.6563" y2="726.6563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="120.5" x2="130.5" y1="730.6563" y2="734.6563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="120.5" x2="608.5" y1="730.6563" y2="730.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="139.5" y="716.0239">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="156.5" y="708.4575">HTTP Success, e.g.:</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="56" x="156.5" y="723.5903">200: OK</text><!--MD5=[2df7760584a169a600fbae3b30ff090d]
@startuml
skinparam NoteTextAlignment left
skinparam Padding 2
skinparam ParticipantPadding 50
skinparam LifelineStrategy solid
autonumber

participant "FHIR Server\nREST API"     as S
participant "Client"                    as C
participant "Client Endpoint\n(HTTP/S)" as E

group Subscription Negotiation
  C->>S: Create Subscription\n""channelType: rest-hook""
  return Success\n""Subscription.status: requested""

  S->>E: HTTP POST - Handshake\n""Bundle:""\n""            Bundle.type: history""\n""SubscriptionStatus.type: handshake""
  return HTTP Success, e.g.:\n""200: OK""

  note right of S
    Server updates Subscription:
    ""Subscription.status: active""
  end note
end

group REST Subscription Processing
else Server sends heartbeat
  S->>E: HTTP POST - Heartbeat\n""Bundle:""\n""            Bundle.type: history""\n""SubscriptionStatus.type: heartbeat""
  return HTTP Success, e.g.:\n""200: OK""
  ...
else Server sends event-notification
  S->>E: HTTP POST - Notification\n""Bundle:""\n""            Bundle.type: history""\n""SubscriptionStatus.type: event-notification""
  return HTTP Success, e.g.:\n""200: OK""
  ...
end
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>